# 基于深度学习的多面体差分攻击及其应用

## 摘要:

Gohr首次将深度学习用于分组密码算法分析, 利用深度残差网络学习特定输入明文差分的密文差分分布特征, 从而构造出满足一定精度的差分神经网络区分器. 



本文结合多面体差分的思想, 提出了一种能够进一步提高精度的**多面体差分神经网络区分器**. 
例如对于 Simeck32/64 算法, 8 轮 3 面体差分神经网络区分器的精度可以从单差分的 89.0% 提升到 96.7%. 

进一步, 利用多面体差分神经网络区分器, 我们**改进了 13 轮的实际密钥恢复攻击**. 



- 首先利用特定明文差分的密文数据集训练了 8 轮的 2 面体差分神经网络区分器和 9 轮的 3 面体差分神经网络区分器, 然后利用概率性扩轮数、中性位扩概率等技术将区分器分别扩展到 11 轮
- 利用贝叶斯优化的密钥搜索策略, 实现了对 Simeck32/64 算法 13 轮的实际密钥恢复攻击, 数据复杂度和时间复杂度分别为 217.7 和 232.8. 与已有的攻击结果相比, 复杂度分别减少为原来的 1/212 和 1/23. 
- 最后, 我们对密钥恢复的几种策略进行了细致分析. 本文提出的多面体差分神经网络区分器也可应用到其它分组密码算法分析中.



## 背景







## 密钥恢复过程

- 明文结构经过 13 轮加密后得到相应密文结构, 猜测最后一轮子密钥, 并利用候选子密钥搜索策略给出候选密钥, 

- 利用这些密钥解密该密文对组, 得到的结果作为输入进入 3 面体神经网络区分器 $N9$, 经区分器和公式计算后得到一组 $V2$ 值,
$$
v_2 = {\sum} _{i=1}^n \; log_2 \;(Z_i^K / (1- Z_i^K))
$$
> (解释：假定多面体神经网络区分器的输入为 $n$ 个密文, 密钥为 $k$,第 $i$ 个密文应的输出为 $Z_i^K,\; Z_i^K \in (0,1)$ , 综合多面体神经网络区分器的多个输出, 可利用上述公式来区分枚举密钥的好坏, 当 $V2$ 值大于一临界值时, 说明该枚举密钥是一个好的密钥. 数据复杂度与 $n$ 值相关.)



- 将该值和临界值 $Cut_1$ 比较, 如果大于 $Cut_1$, 就将解密最后一轮得到的密文结构用于猜测倒数第二轮子密钥.

- 利用猜测的倒数第二轮子密钥，去解密倒数第二轮数据, 得到的结果形如 $(m_0, m_1, m_2)$ , 取 $(m_0, m_1)$ 作为输入进入单差分神经网络区分器 $N8$
- 经区分器和公式(2)计算出该轮的 $V2$ 值, 如果该 $V2$ 值大于临界值 $Cut_2$, 那么用于解密的两轮子密钥即是所求

**说明：**

第一步, 搜索最后一轮候选子密钥; 
第二步, 在最后一轮子密钥确定后, 搜索倒数第二轮子密钥。

两个步骤都利用了输出密文的差分分布特征. 当然, 也可以只利用第一个步骤确定最后一轮子密钥, 增加第二步是为了更好地确认第一步搜索出的最后一轮子密钥的正确性. 第二步对于确定最后一轮子密钥起到了辅助作用